--- Items ---

o CSHL: drag and drop mtz and pdb together from the Finder
* Fix later.

o CSHL: pucker in C++? in New coot? There is no markup and there should be.

o CSHL: molprobity.rna_validate to find RNA suite outliers. Mark this
        up in Coot.

o CSHL: visual feedback on changing the atom occupancies of a residue?
        Animated textures would be nice.

o CSHL: don't pick symmetry atoms when they are not displayed.

o CSHL: Make Link

o CSHL: (in presentation add the anom map figure)

o Coot: use common names in Add Other Solvent dialog - synonyms?

o CSHL: Coot: center of screen crosshairs customizable.
  scale with the zoom.

o CSHL: Coot:: add proportional editing.

o CSHL: 0.9.x delete deviant extra restraints doesn't work

o CSHL: Coot disable double click with trackpad

o CSHL: Coot: environment distances don't update on moving to new residue

o CSHL: Does export of high-res mesh for model as gltf actually export
        a high-res mesh? Consider using instancing.

o CSHL: Coot: add other residue type to other solvent molecules
* Done.

o CSHL: triple-refine auto-accept key binding. Does it exist?
* Yes - the H key.

o CSHL: the display manager is displayed from a state script generated
        when the display manager was not displayed.
* Done.

o CSHL: Add other solvent molecule: add nitrate, NO3
* Done.

o CSHL: open a pdb file in another directory. Now open an mtz file
   - the file dialog should start in the same directory, but it does not.
* Done.

o CSHL: "no unmodelled blobs" dialog needs fixup.
* Done.

o CSHL: remove the startup script and see if it keeps asking about left mouse
* Seems to be doing the right thing.

o CSHL: get monomer - grab the focus
  Does the dialog close properly on enter? No.

o CSHL: undo symmetry view
* Done.

o CSHL: Coot: where is keyboard mutate?
* Done.

o Score lucy's ligands.

o bring delete_link to the user interface in Coot

o key-binding: simple R - and add a shortcut too. Also triple-refine-auto-accept.

o Add delete_link() to libcootapi - it's in coot-molecule

o get some RNA and do a copy fragment. The fragment should have
  orange phosphate atoms.

o colour by dictionary/chain for 3ood ligand.

o when refining carbohydrate, don't find links by distance - use residue numbers and links.
* partially done - needs testing/work for mmcif input.

o Have another look at the carbohydrate builder.

o where are we with the panda inspect interface?

o update build-it-3-3 to the latest version of the RDKit: 2025_03_6

o Add to the EM tutorial (both Coot and moorhen) running MMRRCC before and after
  (morph) fitting.

o have a look at moorhen CMakeLists.txt for how to properly use rdkit libs

o html anchors so that svg (flev) from coot can be used for interactivity in moorhen.

o Moorhen: get the map for the given molecule when using EM structure

o Click and drag the PAE plot

o Ctrl right-mouse to change the clipping planes

o strip spaces on PDB access code entry
  (From Clemens)
* Done.

o after add other solvent moleucle, try valigdtion graphs
   model chooser and you will ssee the ligand as a molecule!
* Done.

o Where did we get to with alt conf colouring or selection (in Coot)
  e.g. untangle chalenge challenge. Look at alt-conf-switcher.py
* Done.

o prefix with "coot-" the CMake executables
* Done.

o For MMRRCC: use a different residue range length for averaging.
* Done.

o moorhen: make a useful interface for atom overlaps
  Write a test.
* Done.

o Get the bonding right for 7045509.cif - the Se1-Br
  bonds are in the cif file (when colour-by-dictionary)

o Put sad markers on unhappy atoms

o talk to Bernie about chapi
* Done.

o move the download from COD to XDG.
* Done.

o make molecules to triangles compile without coot libs
  then split the build of libcootapi to link then
  m2t library.
* Done!

o make some inchi keys for the G* dictionaries. Using my parser and making
  rdkit molecules - do they match the inchi keys from the wwwPDB CCD?
* Done. Good progress

o "Fill partial residues" doesn't work.
* Done.

o "Phosphorylate this residue" doesn't work.
* Done.

o make a function: to update bonds without updating bonding.
  Useful for dynamics.
* OK, done - now I need a means to genate molecule position updates.

o check chemistry - extra hydrogen atom when making a link.
  Example? Reported by Clemens?

o Clemens: edit the alt conf-ids interactively.
  Residue Editor is not enough. Clarify with Clemens.

o Consider atom ids in output from libcootapi/chapi when gemmi is used.
  We need label_atom_id and label_segid (not the auth version of those)

o coot: let's get bansu integrated - for those who don't have acedrg

o Coot: 2 (EM?) maps - don't scroll the map that is not displayed

o libcootapi/moorhen: density correlation for a cid

o libcootapi/moorhen: renumber residues function

o libcootapi add a mask for the fourier shell

o libcootapi: using model and gaussian surface export a mask soft edge (0.0 to 1.0 in floats)

o moorhen/lhasa: use bansu for link generation

o coot:
  contour level for map 1 is 0.187223 pending
  tell me what the step size is also.

o dot and comma don't work for rotamers

o install cctbx (conda install) to get mmtbx.probe2 to get new dots.

o molprobity reduce has updated the hydrogen bond distance (it seems?)
  libcootapi should follow - actually, use distances in new monomer library.

o how to represent missing ligand atoms?
  Draw them in black with a white outline?

o Lucrezia: table of bond and angles and distances vs model table in moorhen

o Moorhen: auto-fit-rotamer without map.

o Delete link in Coot

o Moorhen: environment distances to symmetry-related molecules.

o Robbie: 3lem: B2-B3 link

o in moorhen, maybe coot, draw the dodecs close to CA - not gapped
  witht the rama ball missing.

o Moorhen/libcootapi test fsc with more map pairs

o Coot: go to atom dialog and use numpad enter key. Needs a computer
  with a numpad!

o Coot: bring carbohydrate, in WTA mode, to the gui
  i.e. 4d514356326ca57852d349f9a2e34b7815688673 needs user interface.

o ligand code KCX: make pdb from chapi and read it into moorhen - with hydrogen atoms
  In Lucy's example some hydrogen atoms were disconnected.

o add_molecular_symmetry add this to moorhen/libcootapi

o calculate the bonds up-front and use a container that can generate the bond
  and atom indices from a mol or atom selection that has updated atom positons
  (from dynamics, say).

o set status 0 for more than 100,000 (or so?) vertices
  Make an api function for the user to set the max vertices
* Done

o "de-dust"/hide dust. Maybe the contour level needs to be sent also.
* Done.

o given the residual map, can you find the centres of the blobs? I have in mind
  doing the cryo-EM tutorial non-interactively. Use rings and shift? Use low-resolution
  maps - resample for more speed.

o give me a list of "clashes" in the validation tools in moorhen

o add low-pass filter

o add solvent mask - combine the maps from the gaussian surfaces

o check "Fix nomenclature errors"

o rebuild_fragment_using_dbloop function needs more work.

o this fails to create the directory for the dictionary (it seems):
INFO::       Reading coordinate file: /Users/pemsley/.cache/Coot/coot-download/pdb4dab.ent
INFO:: file /Users/pemsley/.cache/Coot/coot-download/pdb4dab.ent has been read.
PATH p-B
PATH p-C
DEBUG:: try_dynamic_add() using package_data_dir(): /Users/pemsley/install-coot/share/coot
:::::::::::::::: debug in try_dynamic_add() here A with s /Users/pemsley/install-coot/share/coot/lib/data
:::::::::::::::: debug in try_dynamic_add() here A with null cmld
debug:: try_dynamic_add(): here C filename /Users/pemsley/install-coot/share/coot/lib/data/monomers/
DEBUG:: try_dynamic_add(): /Users/pemsley/.cache/Coot/monomers/h does not exist

o on the coot web page say how/where to report a bug.

o read in lib/data/monomers/metals.json - add it to the disribution

o check power-scaled map with 1gwd atom map.

o try 8b0x in flatpak coot. Colour by chain. Missing dictionaries.
  Make an easy way to download all the missing dictionaries

o get_atom_position() add to chapi

o add sphericity test (current analysis) to chapi

o do we have "B-factor analysis" i.e.. show me atoms with B-factor
  more than 70 (or so)

o rdkit mol -> mmcif - for output from layla

o 6ZV ligand - does it display correctly?

o crash on run unit tests:

Stack trace (most recent call last):
#31 | Source "Python/ceval.c", line 6439, in _PyEval_EvalFrame
      Source "./Include/internal/pycore_ceval.h", line 73, in _PyEval_Vector [0x7f1af7462f3f]
#30 | Source "Python/ceval.c", line 5381, in do_call_core
      Source "Python/ceval.c", line 7357, in _PyEval_EvalFrameDefault [0x7f1af745d50f]
#29 | Source "Objects/classobject.c", line 89, in _PyObject_VectorcallTstate
      Source "./Include/internal/pycore_call.h", line 92, in method_vectorcall [0x7f1af735560f]
#28 | Source "Python/ceval.c", line 6439, in _PyEval_EvalFrame
      Source "./Include/internal/pycore_ceval.h", line 73, in _PyEval_Vector [0x7f1af7462f3f]
#27 | Source "Python/ceval.c", line 5381, in do_call_core
      Source "Python/ceval.c", line 7357, in _PyEval_EvalFrameDefault [0x7f1af745d50f]
#26 | Source "Python/ceval.c", line 6439, in _PyEval_EvalFrame
      Source "./Include/internal/pycore_ceval.h", line 73, in _PyEval_Vector [0x7f1af7462f3f]
#25   Source "Python/ceval.c", line 4774, in _PyEval_EvalFrameDefault [0x7f1af745ca28]
#24   Source "Objects/call.c", line 214, in _PyObject_MakeTpCall [0x7f1af73526ec]
#23   Source "Objects/methodobject.c", line 553, in cfunction_call [0x7f1af73a9550]
#22   Source "/home/paule/Projects/coot/git/coot-main/build-arch/src/coot_wrap_python.cc", line 29968, in _wrap_regularize_zone [0x7f1ae64dcc64]
       29965:     SWIG_exception_fail(SWIG_ArgError(res5), "in method '" "regularize_zone" "', argument " "5"" of type '" "char const *""'");
       29966:   }
       29967:   arg5 = reinterpret_cast< char * >(buf5);
      >29968:   result = (int)regularize_zone(arg1,(char const *)arg2,arg3,arg4,(char const *)arg5);
       29969:   resultobj = SWIG_From_int(static_cast< int >(result));
       29970:   if (alloc2 == SWIG_NEWOBJ) delete[] buf2;
       29971:   if (alloc5 == SWIG_NEWOBJ) delete[] buf5;
#21   Source "../../coot/src/c-interface-refine.cc", line 175, in regularize_zone [0x7f1af955f394]
        172:       short int auto_range = 0;
        173:       if (index1 >= 0) {
        174: 	 if (index2 >= 0) {
      > 175: 	    coot::refinement_results_t rr = g.regularize(imol, auto_range, index1, index2);
        176: 	    std::cout << "debug:: restraints results " << rr.found_restraints_flag << " "
        177: 		      << rr.lights.size() << " " << rr.info_text << std::endl;
        178: 	    if (rr.lights.size() > 0)
#20   Source "../../coot/src/graphics-info-modelling.cc", line 2500, in regularize [0x7f1af97a7ccd]
       2497:       std::cout << "Picked atoms are not in the same chain.  Failure" << std::endl;
       2498:    } else {
       2499:       // flash_selection(imol, resno_1, inscode_1, resno_2, inscode_2, altconf, chain_id_1);
      >2500:       rr = copy_mol_and_regularize(imol, resno_1, inscode_1, resno_2, inscode_2, altconf, chain_id_1);
       2501:       short int istat = rr.found_restraints_flag;
       2502:       if (istat) {
       2503: 	 graphics_draw();
#19   Source "../../coot/src/graphics-info-modelling.cc", line 196, in copy_mol_and_regularize [0x7f1af97a774a]
        193: 					 std::string altconf,// use this (e.g. "A") or "".
        194: 					 std::string chain_id_1) {
        195: 
      > 196:    return copy_mol_and_refine(imol, -1, resno_1, inscode_1, resno_2, inscode_2, altconf, chain_id_1);
        197: }
#18   Source "../../coot/src/graphics-info-modelling.cc", line 365, in copy_mol_and_refine [0x7f1af97a74fa]
        362:       // 					  imol_for_map);
        363: 
        364:       if (imol_for_map == -1)
      > 365: 	 rr = regularize_residues_vec(imol_for_atoms, residues, altconf, mol);
        366:       else
        367: 	 rr = refine_residues_vec(imol_for_atoms, residues, altconf, mol);
        368:    }
#17   Source "../../coot/src/graphics-info-modelling.cc", line 1201, in regularize_residues_vec [0x7f1af97a6be2]
       1198: 					 mmdb::Manager *mol) {
       1199: 
       1200:    bool use_map_flag = 0;
      >1201:    coot::refinement_results_t rr = generate_molecule_and_refine(imol, residues, alt_conf, mol, use_map_flag);
       1202:    short int istat = rr.found_restraints_flag;
       1203:    if (istat) {
       1204:       graphics_draw();
#16   Source "../../coot/src/graphics-info-modelling.cc", line 1654, in generate_molecule_and_refine [0x7f1af97a64b0]
       1651: 	    check_dictionary_for_residue_restraints(imol, residues);
       1652: 	 if (icheck.first == 0) {
       1653: 	    // info_dialog_missing_refinement_residues(icheck.second);
      >1654: 	    show_missing_refinement_residues_dialog(icheck.second, false);
       1655: 	 }
       1656:       }
       1657:    }
#15   Source "../../coot/src/graphics-info-modelling.cc", line 383, in show_missing_refinement_residues_dialog [0x7f1af97960e7]
        380:    gtk_widget_set_visible(vbox, TRUE);
        381:    clear_out_container(vbox);
        382:    for (const auto &rn : res_names) {
      > 383:       GtkWidget *label = gtk_label_new(rn.c_str());
        384:       char* ccx = new char[rn.size() + 1];
        385:       for (unsigned int ii=0; ii<=rn.size(); ii++) ccx[ii] = 0;
        386:       std::copy(rn.begin(), rn.end(), ccx);

o Ctrl-S should add something to the log.

o check that these work as expected (Martin Maly anom test):
   coot.set_map_radius(7.52)
   coot.set_map_radius_em(52.60)

o Assign sequence gui needs fixing..
* Done.

o Let's move the light for different shadows in Fancy Mode

o in cfc, give me a button that shows the chemical features
* Done.

o halogen ligand interaction - investigate.

o refine a structure with the wrong magnification and look at the
  distortion of the bond lengths. I have done some work on this,
  but where is it?

o CFC should also check for pi-stacking to the protein
  (i.e. not just internal chemical features)

o do a better job at the 3d "icons" for chemical
  features - so that I can tell what it is from the shape.
  Maybe use blender to make the "icons"
  Can you indicate the number of contributors somehow? Size?

o what is PLIP(ify) Interaction Key?
  https://github.com/volkamerlab/plipify
  Salentin, S. et al. PLIP: fully automated protein-ligand interaction profiler.
  Nucl. Acids Res., 2015, 43 (W1): W443-W447.
  Uses conda - what does it depend on and can it be used outside of conda?

o show the PLI interactions in 3d (in moorhen too)

o external Rama torsion restraints for servalcat

o make "Environment Distances" an overlay

o make downloading emd map an overlay

o Ctrl-M should merge molecule (active ligand) into other model.
  Or just rewrite the "Review/Accept Ligands" dialog.

o fix relocatable installation of coot-residue-density-fit
  see the homebrew install

o put contact dots on the residues around the ligand.
  How about hexagonal slabs (instead of balls) as
  an option? (Tricky to get the orientation correct "between" atoms).

o pickable ribbons.
  Big Job.

o Highlightable/pickable genericic objects

o double-click on a symmetry atom to label.

o does get_ligand_validation_vs_dictionary() do good things?
  Does it give ceus?

o Bonds and angles validation on 2d diagram from chapi
  as svg.

o arwen, alejandro, santosh, dorothee

o have another look at the PAE drag box for residue selection

o Take a cif molecule, copy it, move the copy to symmetry-related position
  merge with first and write out the cif. Is the header (secondary structure)
  preserved in the outpute cif?

o Robbie: 3pdt is Mg and should be K. A2.

o moorhen (and coot) ribbon diagram coloured by b-factor

o read in a molecule, make a molecule with DNA models. Refine DNA, then
  try to undo refinement of DNA. Fails. 8v1w.

o check that hydrogen bonds are displayed correctly.
  See update_hydrogen_bond_mesh()

o fix the map caps. Make it work in moorhen. Single colour mode and joined edges.
  Slice "solid" maps.

--- Other Items ---

o "Flood the blob with dummy atoms" - useful of pomgnt2

o import cif dictionary from string.

o Add ability to rotate view around z axis :: 0.5

o auto-scale the make-a-difference map
  think about create power-matched option also? It's in chapi :: 1

o colour stops for b-factor analysis, rather than colour wheel. :: 1

o have another look at Rama plot :: 1

o Add curl fetch stuff to chapi api. Use modern accession codes.

o address-sanitizer for coot

o Fix the "Fetch" buttons - new GTK4/glib? :: 2

o "Proportional editing" molecule rotation :: 2
  Actually "fragment" rotation makes more sense.

o Get in touch with Kay for the display of h,k,l as atoms (cif)
* Done. Progress has been made.

o Atom sphere radius depends on B-factor - proportional to cube root maybe?
  set_atom_radius_by_b_factor_mode(imol, state)
  atom_radius_by_b_factor_scale_factor(imol, sf)

o draw 9c1h with molecular symmetry colouring :: 1
  turn on set_colour_by_ncs_chain(imol, 1)

o "Proportional editing" molecule rotation :: 2
  Actually "fragment" rotation makes more sense.

o try texture atlas for text - make a new test app from scratch :: 4

o WTA carbohydrate :: 6

o what does "RenameVerticesAndTriangles()" do? Do we need it?

o Cross-out "Screenshot" unless we have OpenGL 4.2 or later :: 0.5

o Highlight the chain neighbours in the Rama plot. Bring back the green square.

o how do I make the HUD buttons have rounded edges? Can I make the health bars
  have rounded edges?

o Rama and Rota graphs validation graphs have terrible scaling - difficult to fix :: 4

o Have a look at contact dots during refinement - with the 3a3a say, there is hang, and the
  final refined structure is shown - there is no animation :: 2

o Have a look at the poly-TRP problem of sequence identification. :: 4

o  It was a strange bit of code in get_group().
   Now the issue is duplication of the model on writing. mmdb bug.
   Solved now? Am I using the right version?

--- Done Items ---

o check for g.display_control_window() usage - they should
  not be needed these days, I think.
* Done

o make "Copy Fragment" an overlay
* Done.

o get rid of generic object functions from graphics-info.h
  Put them in aa new file along with
  bool is_valid_generic_display_object_number(int obj_no) const;
* Done

o add header guard to gizmo and gensurf headers
* Done.

o change stringify_error_message to stringify_error_code
* Done

o rename Cartesian.h to Cartesian.hh
* Done.

o Move Molecule Here should be an overlay
* Done.

o Talk to Stuart:
::function get_atom not found - out of 386 docstrings
::function get_atom_using_cid not found - out of 386 docstrings
::function get_residue not found - out of 386 docstrings
::function get_residue_using_cid not found - out of 386 docstrings
* Done

o Move Molecule Here should be an overlay
* Done

o move make_directory_maybe() to take std::string arg.
  Will need to change the header. Maybe a new header?
* Done.

o side-chain 180 should do a syn/anti flip for nucleotide bases
  i.e. rotate 180 around C1-N1 (or N9)
  Make a video. In chapi too?

o what are the chi angles for ASN? In sequons? With link
  to NAG?
* for Lucrezia. Use top 3000 filtering on modern structures to
  get new reference set.

o User-defined filename filter for coords file open
  https://docs.gtk.org/gtk4/class.FileFilter.html
* Assigned to Jakub

o make a file that maps CCD-id to RDKit Canonical SMILES.
  (is the SMILES in Acedrg output the canonical SMILES?)
* Looks good. Jakub to continue this

o Add split water to new coot
* Done.

o install latest chapi, python3 import coot_headless_api
  then the molecules_container_t gives an error message
  about COOT_PREFIX
* Not for me.

o std::bad_alloc when fitting waters in chapi - maybe.
  Put some protection in.
* Done.

o filename filter for coords file open
  https://docs.gtk.org/gtk4/class.FileFilter.html
  Done. But now I think that this is not what Oli wanted.
  There should be a user-defined globbing string.
  Add a GtkFileDialog to a dialog. See google docs notes.

o multi-select for maps
* Done

o 2vf7: alphafold model tutorial? Or is it too close to the actual model?
  *It's too close.  Good idea though.

o bernie comments
* Done.

o refine_residue_using_cid "CHAIN": too much debugging information
* Done.

o Fix curlew (download to wrong directory)
* Done.

o make a function that returns the secondary structure for libcootapi/chapi
* Done.

o print the key bindings
* Done.

o add-water should have a key-binding
* Done.

o swig should not be a dependency if building chapi
* Done. And done.

o Process Stuart's outliers file ::: 1
* Done

o fix the colour wheel in B-factor analysis ::: 1
  1geh B-factor colour ramp looks wrong

o Add Metals to Coot startup, Moorhen and chapi ::: 0.2
* Done.

o Save symmetry coordinates.
* Done

o what is the radius of gyration? Make a function. ::: 1
* Done.

o remove GEMMI hack at top of atom-selection-container.cc ::: 0.2

o make a function that returns the secondary structure for libcootapi/chapi
* Done

o key-binding for smooth bonds
* Done.

o layla needs a wrapper and to be moved to libexec
* Done.

o get rid of debugging on get_h_bonds()
* Done. Nice.

o move make_directory_maybe() to take std::string arg.
  Will need to change the header. Maybe a new header?
* Done.

